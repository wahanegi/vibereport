<%= form_with model: @session, url: send(Passwordless.mounted_as).sign_in_path, data: { turbo: 'false'} do |f| %>
  <div class="mx-auto mt125 min-w675">
    <h1 class="color-black">
      Oh, hi there! <br/>
      <p class="b1 mb-4 gray-600">Welcome to</p>
    </h1>
    <div class="mt-17 position-relative fs-7">Logo/Brand</div>
    <%= image_tag("envelope.png", width: 190, height: 87) %>
    <% if flash.to_h["error"] == 'Expired!' %>
      <h3 class="gray-600 my-4">Your login link may have expired. Click here to get a new one</h3>
    <% else %>
    <div class="w588-h59 mt-3 mb-6 mx-auto pt-1">
      <div class="gray-600 b3">Enter your email address and weâ€™ll send you a link
      <br>
      to access your check-in and profile</div>
    </div>
    <% end %>
    <div class="b1 my-1">
      <% email_field_name = :"passwordless[#{@email_field}]" %>
      <%= text_field_tag email_field_name, params.fetch(email_field_name, nil), placeholder: "Enter email here", id: "email-input", class:"mt-4 w660"%>
    </div>
    <div class="d-flex align-items-center mt162">
      <%= f.submit 'Next', class: "btn btn-regular c1 fs-5", id: "next-button", disabled: true %>
    </div>
    <div class="t767-min-w650 position-absolute w-100 d-flex justify-content-end px-5 h0">
      <%= link_to image_tag("help.svg"), "mailto: support@#{ENV.fetch('EMAIL_DOMAIN')}", class: 'help-icon' %>
    </div>
  </div>
<% end %>
<script type="text/javascript">
  window.onload = function() {
    $(document).ready(function() {
      // Get the input and button elements
      const input = $("#email-input");
      const button = $('#next-button');
      // Attach an event listener to the input field
      input.on('input', function() {
        // Check if the email is valid using a regular expression
        if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(input.val())) {
          button.attr('disabled', false);
        } else {
          button.attr('disabled', true);
        }
      });
    });
  }
</script>